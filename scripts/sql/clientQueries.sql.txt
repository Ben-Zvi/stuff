

//Simple query
query='select * from  dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`'

//Schema change bug
query="select t.c.`value` from (select flatten(x.fields.map) c from `dfs`.`/Users/pchandra/work/data/customer/ericsson/ta_netstat.snappy.parquet` x) t"
query="select t2.flat_kpis.key from (select flatten(t.esr.member0.kpis.map) as flat_kpis from `dfs`.`/Users/pchandra/work/data/customer/ericsson/esr_part-m-00000.snappy.parquet` as t) as t2"

// No results
query='select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 '

// Test Data types
query='select * from  dfs.`/Users/pchandra/work/data/test/testTypes.json`'

query='select cast(join_date as timestamp) TIMEST, cast(join_date as date) DT, cast(join_time as TIME) TM, cast(days_worked as INTERVAL DAY) as INT_DAY, cast(years_worked as INTERVAL YEAR) as INT_YR, cast(salary as DECIMAL(9,2)) as DEC9, cast(salary as DECIMAL(18,2)) as DEC18, cast(salary as DECIMAL(28,2)) as DEC28D, cast(salary as DECIMAL(38,2)) as DEC38D, cast(salary as DECIMAL(28,2))+cast(salary as DECIMAL(28,2)) as DEC28S, cast(salary as DECIMAL(38,2))+cast(salary as DECIMAL(28,2)) as DEC38S    from dfs.`/Users/pchandra/work/data/test/testTypes.json`'


// Queries with errors
query=‘select some error’

// Parallel Queries

// parallel queries

query='select cast(join_date as timestamp) TIMEST, cast(join_date as date) DT, cast(join_time as TIME) TM, cast(days_worked as INTERVAL DAY) as INT_DAY, cast(years_worked as INTERVAL YEAR) as INT_YR, cast(salary as DECIMAL(9,2)) as DEC9, cast(salary as DECIMAL(18,2)) as DEC18, cast(salary as DECIMAL(28,2)) as DEC28D, cast(salary as DECIMAL(38,2)) as DEC38D, cast(salary as DECIMAL(28,2))+cast(salary as DECIMAL(28,2)) as DEC28S, cast(salary as DECIMAL(38,2))+cast(salary as DECIMAL(28,2)) as DEC38S    from dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`;;select * from  dfs.`/Users/pchandra/work/data/tpc-h/nation.parquet`;select * from  dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0;select L_ORDERKEY,    L_PARTKEY,    L_SUPPKEY,    L_LINENUMBER,    L_QUANTITY,    L_EXTENDEDPRICE,    L_DISCOUNT,    L_TAX,    L_RETURNFLAG,    L_LINESTATUS,    L_SHIPDATE,    L_COMMITDATE,    L_RECEIPTDATE,    L_SHIPINSTRUCT,    L_SHIPMODE,    L_COMMENT     from dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet`;select cast(join_date as timestamp) TIMEST, cast(join_date as date) DT, cast(join_time as TIME) TM, cast(days_worked as INTERVAL DAY) as INT_DAY, cast(years_worked as INTERVAL YEAR) as INT_YR, cast(salary as DECIMAL(9,2)) as DEC9, cast(salary as DECIMAL(18,2)) as DEC18, cast(salary as DECIMAL(28,2)) as DEC28D, cast(salary as DECIMAL(38,2)) as DEC38D, cast(salary as DECIMAL(28,2))+cast(salary as DECIMAL(28,2)) as DEC28S, cast(salary as DECIMAL(38,2))+cast(salary as DECIMAL(28,2)) as DEC38S    from dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`;;select * from  dfs.`/Users/pchandra/work/data/tpc-h/nation.parquet`;select * from  dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0;select L_ORDERKEY,    L_PARTKEY,    L_SUPPKEY,    L_LINENUMBER,    L_QUANTITY,    L_EXTENDEDPRICE,    L_DISCOUNT,    L_TAX,    L_RETURNFLAG,    L_LINESTATUS,    L_SHIPDATE,    L_COMMITDATE,    L_RECEIPTDATE,    L_SHIPINSTRUCT,    L_SHIPMODE,    L_COMMENT     from dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet`;select cast(join_date as timestamp) TIMEST, cast(join_date as date) DT, cast(join_time as TIME) TM, cast(days_worked as INTERVAL DAY) as INT_DAY, cast(years_worked as INTERVAL YEAR) as INT_YR, cast(salary as DECIMAL(9,2)) as DEC9, cast(salary as DECIMAL(18,2)) as DEC18, cast(salary as DECIMAL(28,2)) as DEC28D, cast(salary as DECIMAL(38,2)) as DEC38D, cast(salary as DECIMAL(28,2))+cast(salary as DECIMAL(28,2)) as DEC28S, cast(salary as DECIMAL(38,2))+cast(salary as DECIMAL(28,2)) as DEC38S    from dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`;;select * from  dfs.`/Users/pchandra/work/data/tpc-h/nation.parquet`;select * from  dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0;select L_ORDERKEY,    L_PARTKEY,    L_SUPPKEY,    L_LINENUMBER,    L_QUANTITY,    L_EXTENDEDPRICE,    L_DISCOUNT,    L_TAX,    L_RETURNFLAG,    L_LINESTATUS,    L_SHIPDATE,    L_COMMITDATE,    L_RECEIPTDATE,    L_SHIPINSTRUCT,    L_SHIPMODE,    L_COMMENT     from dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet`;select cast(join_date as timestamp) TIMEST, cast(join_date as date) DT, cast(join_time as TIME) TM, cast(days_worked as INTERVAL DAY) as INT_DAY, cast(years_worked as INTERVAL YEAR) as INT_YR, cast(salary as DECIMAL(9,2)) as DEC9, cast(salary as DECIMAL(18,2)) as DEC18, cast(salary as DECIMAL(28,2)) as DEC28D, cast(salary as DECIMAL(38,2)) as DEC38D, cast(salary as DECIMAL(28,2))+cast(salary as DECIMAL(28,2)) as DEC28S, cast(salary as DECIMAL(38,2))+cast(salary as DECIMAL(28,2)) as DEC38S    from dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`;;select * from  dfs.`/Users/pchandra/work/data/tpc-h/nation.parquet`;select * from  dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0;select L_ORDERKEY,    L_PARTKEY,    L_SUPPKEY,    L_LINENUMBER,    L_QUANTITY,    L_EXTENDEDPRICE,    L_DISCOUNT,    L_TAX,    L_RETURNFLAG,    L_LINESTATUS,    L_SHIPDATE,    L_COMMITDATE,    L_RECEIPTDATE,    L_SHIPINSTRUCT,    L_SHIPMODE,    L_COMMENT     from dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet`;select cast(join_date as timestamp) TIMEST, cast(join_date as date) DT, cast(join_time as TIME) TM, cast(days_worked as INTERVAL DAY) as INT_DAY, cast(years_worked as INTERVAL YEAR) as INT_YR, cast(salary as DECIMAL(9,2)) as DEC9, cast(salary as DECIMAL(18,2)) as DEC18, cast(salary as DECIMAL(28,2)) as DEC28D, cast(salary as DECIMAL(38,2)) as DEC38D, cast(salary as DECIMAL(28,2))+cast(salary as DECIMAL(28,2)) as DEC28S, cast(salary as DECIMAL(38,2))+cast(salary as DECIMAL(28,2)) as DEC38S    from dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`;;select * from  dfs.`/Users/pchandra/work/data/tpc-h/nation.parquet`;select * from  dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0;select L_ORDERKEY,    L_PARTKEY,    L_SUPPKEY,    L_LINENUMBER,    L_QUANTITY,    L_EXTENDEDPRICE,    L_DISCOUNT,    L_TAX,    L_RETURNFLAG,    L_LINESTATUS,    L_SHIPDATE,    L_COMMITDATE,    L_RECEIPTDATE,    L_SHIPINSTRUCT,    L_SHIPMODE,    L_COMMENT     from dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet`;select cast(join_date as timestamp) TIMEST, cast(join_date as date) DT, cast(join_time as TIME) TM, cast(days_worked as INTERVAL DAY) as INT_DAY, cast(years_worked as INTERVAL YEAR) as INT_YR, cast(salary as DECIMAL(9,2)) as DEC9, cast(salary as DECIMAL(18,2)) as DEC18, cast(salary as DECIMAL(28,2)) as DEC28D, cast(salary as DECIMAL(38,2)) as DEC38D, cast(salary as DECIMAL(28,2))+cast(salary as DECIMAL(28,2)) as DEC28S, cast(salary as DECIMAL(38,2))+cast(salary as DECIMAL(28,2)) as DEC38S    from dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`;;select * from  dfs.`/Users/pchandra/work/data/tpc-h/nation.parquet`;select * from  dfs.`/Users/pchandra/work/data/test/testTypes.json`;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0 ;select * from  dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet` where L_ORDERKEY = 0;select L_ORDERKEY,    L_PARTKEY,    L_SUPPKEY,    L_LINENUMBER,    L_QUANTITY,    L_EXTENDEDPRICE,    L_DISCOUNT,    L_TAX,    L_RETURNFLAG,    L_LINESTATUS,    L_SHIPDATE,    L_COMMITDATE,    L_RECEIPTDATE,    L_SHIPINSTRUCT,    L_SHIPMODE,    L_COMMENT     from dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet`’


// parallel queries; some with ERRORS




// parallel queries on TPC-H source data
query='select L_ORDERKEY,    L_PARTKEY,    L_SUPPKEY,    L_LINENUMBER,    L_QUANTITY,    L_EXTENDEDPRICE,    L_DISCOUNT,    L_TAX,    L_RETURNFLAG,    L_LINESTATUS,    L_SHIPDATE,    L_COMMITDATE,    L_RECEIPTDATE,    L_SHIPINSTRUCT,    L_SHIPMODE,    L_COMMENT     from dfs.`/Users/pchandra/work/data/tpc-h/lineitem.parquet`;select '*' from dfs.`/Users/pchandra/work/data/tpc-h/customer.parquet`;select '*' from dfs.`/Users/pchandra/work/data/tpc-h/orders.parquet`;select '*' from dfs.`/Users/pchandra/work/data/tpc-h/nation.parquet`;select '*' from dfs.`/Users/pchandra/work/data/tpc-h/part.parquet`;select '*' from dfs.`/Users/pchandra/work/data/tpc-h/partsupp.parquet`;select '*' from dfs.`/Users/pchandra/work/data/tpc-h/region.parquet`;select '*' from dfs.`/Users/pchandra/work/data/tpc-h/supplier.parquet`'

// Large result set
query='select * from dfs.`/Users/pchandra/work/data/parquet/big/orders_part-m-00001.parquet`'

// explain
query=' explain plan for select * from dfs.`/Users/pchandra/work/data/parquet/big/orders_part-m-00001.parquet`'

// Replaying ODBC queries to reproduce hanging client issue (Needs Krystal’s HBase and hive setup)

query='SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hbase" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hbase`.`voter`; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hive.default" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME;'

query='select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hbase" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hbase`.`voter`; SELECT * FROM `hbase`.`voter` LIMIT 100; DESCRIBE `hbase`.`student`; SELECT * FROM `hbase`.`student` LIMIT 100; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hive.default" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hive`.`default`.voter_qa2; SELECT * FROM `hive`.`default`.`voter_qa2` LIMIT 100; DESCRIBE `hive`.`default`.student_qa2; SELECT * FROM `hive`.`default`.`student_qa2` LIMIT 100; SHOW FILES IN `dfs`.`views`.`.//`; DESCRIBE `dfs`.`views`.`web_sales`; SELECT * FROM `dfs`.`views`.`web_sales` LIMIT 100;select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hbase" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hbase`.`voter`; SELECT * FROM `hbase`.`voter` LIMIT 100; DESCRIBE `hbase`.`student`; SELECT * FROM `hbase`.`student` LIMIT 100; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hive.default" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hive`.`default`.voter_qa2; SELECT * FROM `hive`.`default`.`voter_qa2` LIMIT 100; DESCRIBE `hive`.`default`.student_qa2; SELECT * FROM `hive`.`default`.`student_qa2` LIMIT 100; SHOW FILES IN `dfs`.`views`.`.//`; DESCRIBE `dfs`.`views`.`web_sales`; SELECT * FROM `dfs`.`views`.`web_sales` LIMIT 100;select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hbase" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hbase`.`voter`; SELECT * FROM `hbase`.`voter` LIMIT 100; DESCRIBE `hbase`.`student`; SELECT * FROM `hbase`.`student` LIMIT 100; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hive.default" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hive`.`default`.voter_qa2; SELECT * FROM `hive`.`default`.`voter_qa2` LIMIT 100; DESCRIBE `hive`.`default`.student_qa2; SELECT * FROM `hive`.`default`.`student_qa2` LIMIT 100; SHOW FILES IN `dfs`.`views`.`.//`; DESCRIBE `dfs`.`views`.`web_sales`; SELECT * FROM `dfs`.`views`.`web_sales` LIMIT 100;select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hbase" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hbase`.`voter`; SELECT * FROM `hbase`.`voter` LIMIT 100; DESCRIBE `hbase`.`student`; SELECT * FROM `hbase`.`student` LIMIT 100; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hive.default" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hive`.`default`.voter_qa2; SELECT * FROM `hive`.`default`.`voter_qa2` LIMIT 100; DESCRIBE `hive`.`default`.student_qa2; SELECT * FROM `hive`.`default`.`student_qa2` LIMIT 100; SHOW FILES IN `dfs`.`views`.`.//`; DESCRIBE `dfs`.`views`.`web_sales`; SELECT * FROM `dfs`.`views`.`web_sales` LIMIT 100;select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME LIKE "%" AND SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA"; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hbase" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hbase`.`voter`; SELECT * FROM `hbase`.`voter` LIMIT 100; DESCRIBE `hbase`.`student`; SELECT * FROM `hbase`.`student` LIMIT 100; SELECT * FROM INFORMATION_SCHEMA.`TABLES` WHERE TABLE_SCHEMA="hive.default" ORDER BY TABLE_TYPE, TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME; DESCRIBE `hive`.`default`.voter_qa2; SELECT * FROM `hive`.`default`.`voter_qa2` LIMIT 100; DESCRIBE `hive`.`default`.student_qa2; SELECT * FROM `hive`.`default`.`student_qa2` LIMIT 100; SHOW FILES IN `dfs`.`views`.`.//`; DESCRIBE `dfs`.`views`.`web_sales`; SELECT * FROM `dfs`.`views`.`web_sales` LIMIT 100'

//Information schema
query='select * from INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME <> "sys" AND SCHEMA_NAME <> "INFORMATION_SCHEMA";'


// Ericsson UNION query
schema=’ericsson.online’
query=‘ SELECT t.`timestamp` TS FROM `trigger/part-m-00006.json` t UNION ALL SELECT l.`source` FROM `trigger/part-m-00006.json` l ‘

query=‘ SELECT e.`imsi`  FROM `esr/part-m-00006.json` e’

query=‘ SELECT cast(`imsi` as varchar(0))  FROM `ebm/*.json` ‘


SELECT  sub1.source, sub1.`timestamp`, sub1.imsi, sub1.msisdn, sub1.imeitac, sub1.`start`, sub1.dur, sub1.eul_cat, sub1.hs_cat, sub1.mcc, sub1.mnc, sub1.sources, sub1.staple, sub1.captool, sub1.bearer_active, sub1.bearer_apn, sub1.bearer_bid, sub1.bearer_gbr_dl, sub1.bearer_gbr_ul, sub1.bearer_ipv4, sub1.bearer_ipv6, sub1.bearer_max_dl, sub1.bearer_max_ul, sub1.bearer_qci, sub1.bearer_thp, sub1.bearer_traffic_class, sub1.kpis.key as kpi_name, sub1.kpis.`value`.`value` as kpi_value, sub1.kpis.`value`.weight as kpi_weight, sub1.kpis.`value`.location_identifier as location_identifier, sub1.kpis.`value`.bid as bid, sub1.kpis.`value`.dimensions.protocol as protocol, sub1.kpis.`value`.dimensions.functionality as functionality, sub1.kpis.`value`.dimensions.encapsulation as encapsulation, sub1.kpis.`value`.dimensions.encryption as encryption, sub1.kpis.`value`.dimensions.service_provider as service_provider, sub1.kpis.`value`.dimensions.client_application as client_application, sub1.kpis.`value`.dimensions.traffic_category as traffic_category, sub1.kpis.`value`.dimensions.server as server, sub1.kpis.`value`.dimensions.type as type  from (select t.source as source, t.`timestamp` as `timestamp`, t.esr.imeitac as imeitac, t.esr.dur as dur, t.esr.msisdn as msisdn, t.esr.imsi as imsi, t.esr.eul_cat as eul_cat, t.esr.hs_cat as hs_cat, t.esr.mcc as mcc, t.esr.mnc as mnc, t.esr.sources as sources, t.esr.staple as staple, t.esr.`start` as `start`, t.esr.captool as captool, t.esr.bearer.active as bearer_active, t.esr.bearer.apn as bearer_apn, t.esr.bearer.bid as bearer_bid, t.esr.bearer.gbr_dl as bearer_gbr_dl, t.esr.bearer.gbr_ul as bearer_gbr_ul, t.esr.bearer.ipv4 as bearer_ipv4, t.esr.bearer.ipv6 as bearer_ipv6, t.esr.bearer.max_dl as bearer_max_dl, t.esr.bearer.max_ul as bearer_max_ul, t.esr.bearer.qci as bearer_qci, t.esr.bearer.thp as bearer_thp, t.esr.bearer.traf_class as bearer_traffic_class, flatten(kvgen(t.esr.kpis)) kpis from `esr` t) sub1




Select sub1.source, sub1.`timestamp`, sub1.imeitac, sub1.dur, sub1.msisdn, sub1.imsi, sub1.eul_cat, sub1.hs_cat, sub1.mcc, sub1.mnc, sub1.`start`, sub1.staple, sub1.trig.key as trigger_name, sub1.trig.`value`.`time` as trigger_time, sub1.trig.`value`.loc as trigger_loc, sub1.trig.`value`.rsrp as trigger_rsrp, sub1.trig.`value`.rsrq as trigger_rsrq, sub1.trig.`value`.code as trigger_code, sub1.trig.`value`.subcode as trigger_subcode, sub1.trig.`value`.cause as trigger_cause, sub1.trig.`value`.fault_code as fault_code, sub1.trig.`value`.internal_cause as trigger_internal_cause, sub1.trig.`value`.service_reason_return_code as trigger_service_reason_return_code, sub1.trig.`value`.apn as trigger_apn, sub1.trig.`value`.node as trigger_node, sub1.trig.`value`.`result` as trigger_result, sub1.trig.`value`.sub_cause as trigger_sub_cause, sub1.trig.`value`.gtp_cause_code as trigger_gtp_cause_code, sub1.trig.`value`.gtp_cause_text as trigger_gtp_cause_text, sub1.trig.`value`.source as trigger_value_source,sub1.trig.`value`.old_tac as trigger_old_tac, sub1.trig.`value`.new_tac as trigger_new_tac, sub1.trig.`value`.old_mcc as trigger_old_mcc, sub1.trig.`value`.old_mnc as trigger_old_mnc, sub1.trig.`value`.new_mcc as trigger_new_mcc, sub1.trig.`value`.new_mnc as trigger_new_mnc from (SELECT t.source as source, t.`timestamp` as `timestamp`, t.esr.imeitac as imeitac, t.esr.dur as dur, t.esr.msisdn as msisdn, t.esr.imsi as imsi, t.esr.eul_cat as eul_cat, t.esr.hs_cat as hs_cat, t.esr.mcc as mcc, t.esr.mnc as mnc, t.esr.sources as sources, t.esr.staple as staple, t.esr.`start` as `start`, t.esr.captool as captool, flatten(kvgen(t.esr.`trigger`)) as trig from `trigger/*.json` t) sub1


Select kvgen(t.esr.`trigger`) as trig from `trigger/*.json` t
